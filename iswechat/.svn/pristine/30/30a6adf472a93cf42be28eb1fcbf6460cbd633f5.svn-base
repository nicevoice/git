<?php
namespace Home\Controller;
use Think\Controller;
import('Home.Lib.wechat');
use Home\Model\QuestionModel as Question;
class IndexController extends Controller
{
    private $wechat;
    public function __construct()
    {
        $options = array(
            'token'=>'556afbd29a8e35c6600d', //填写你设定的key
            'encodingaeskey'=>'rpceX8JqtX3pcQJxDXfEGecKhPQadesrqsYbq79jm6i', //填写加密用的EncodingAESKey
        );
        $this->wechat = new \Wechat($options);
    }
    public function index()
    {

        $User = new Question();
        printR($User->getQuestion2Key($ret));


        printR($ret);
        $this->wechat->valid();//明文或兼容模式可以在接口验证通过后注释此句，但加密模式一定不能注释，否则会验证失败
        $type = $this->wechat->getRev()->getRevType();
        switch($type) {
            case \Wechat::MSGTYPE_TEXT:
                $this->wechat->text("hello, I'm wechat")->reply();
                exit;
                break;
            case \Wechat::MSGTYPE_EVENT:
                break;
            case \Wechat::MSGTYPE_IMAGE:
                break;
            default:
                $this->wechat->text("help info")->reply();
        }
    }
}